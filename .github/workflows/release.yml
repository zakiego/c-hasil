name: Release Database to Files

on:
  push
  # schedule:
  #   - cron: "0 0 * * *" # at GMT+8, it will run at 8 AM

env:
  DATABASE_URL: ${{ secrets.DATABASE_URL }}

permissions:
  actions: write
  contents: write

jobs:
  run:
    runs-on: self-hosted
    timeout-minutes: 60 # 1 hour
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.9"
          cache: "pip" # caching pip dependencies
      - run: pip install -r src/releaser/requirements.txt
      - run: python src/releaser/main.py
